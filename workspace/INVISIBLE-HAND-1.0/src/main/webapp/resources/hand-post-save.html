<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<link rel="icon" href="image/favicon-32x32.png">
<!-- CSS only -->
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-rbsA2VBKQhggwzxH7pPCaAqO46MgnOM80zW1RWuH61DGLwZJEdK2Kadq2F9CUG65" crossorigin="anonymous">
<!-- JavaScript Bundle with Popper -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-kenU1KFdBIe4zVF0s0G1M5b4hcpxyD9F7jL+jjXkk+Q2h455rYXK/7HAuoJl+0I4" crossorigin="anonymous"></script>
<link rel="stylesheet" href="css/common.css">
<link rel="stylesheet" href="css/hand-board.css">
<title>게시글 등록/수정페이지입니다</title>
</head>
<body>
  <!-- *---header Start---* -->
	  <header class="header">
    <div class="inner">
			<div class="logo">
			 <a href="#"><img src="image/pngaaa.com-589654.png" alt="logo" /></a>
			</div>
	      <nav class="gnb_wrap">
	        <ul class="global_nav_bar">
	            <li><a href="#">차트정보</a></li>
	            <li><a href="#">마이기업솔루션</a></li>
	            <li><a href="#">커뮤니티</a></li>

	        </ul>
	        <ul class="local_nav_bar">
	            <li>
	                <ul class="sub-menu">
	                    <li>서브메뉴1</li>
	                    <li>서브메뉴1</li>
	                    <li>서브메뉴1</li>
	                    <li>서브메뉴1</li>
	                </ul>
	            </li>
	            <li>
	                <ul class="sub-menu">
	                    <li>서브메뉴2</li>
	                    <li>서브메뉴2</li>
	                    <li>서브메뉴2</li>
	                    <li>서브메뉴2</li>
	                </ul>
	            </li>
	            <li>
	                <ul class="sub-menu">
	                    <li>자유게시판</li>
	                    <li>QnA</li>
	                    <li>공지사항</li>
	                </ul>
	            </li>
	        </ul>
	      </nav>
	      
	    <div class="login">
	     <a href="#"><span>로그인</span></a>
	    </div>
    </div>
	</header>
	
	
	<!-- **---header End---** -->
	<!-- *---container Start---* -->

	<div class="h60px"></div>
	<div class="container-1400 con-main min-100vh">
	
		<div class="wrap-1000 ">
		  <h1>게시판</h1>
		  


		      <!-- 버튼 -->
    <div class="row g-1 d-flex justify-content-end">
      <div class="col-auto">
        <input type="button" class="btn" value="목록" id="moveToList">
        <input type="button" class="btn" value="등록" id="doSave">
      </div>
    </div>
    <!--// 버튼 ----------------------------------------------------------------->
    <form action="#"  name="reg_frm" id="reg_frm">
       <input type="hidden" name="div" id="div" value="${inVO.getDiv()}">
        <div class="mb-3">
          <label for="exampleFormControlInput1" class="form-label">제목</label>
          <input type="text" class="form-control title_cls" id="title"  name="title"
             placeholder="제목을 입력 하세요." required="required" maxlength="66">
        </div>
        
        <div class="mb-3">
          <label for="exampleFormControlInput1" class="form-label">등록자ID</label>
          <input type="text" class="form-control" id="regId" name="regId" value="${sessionScope.user.userId }"
          placeholder="아이디를 입력 하세요." readonly="readonly">
        </div>
        
        <div class="mb-3">
          <label for="exampleFormControlTextarea1" class="form-label">내용</label>
          <textarea class="form-control" id="contents" name="contents" rows="3" required="required"></textarea>
        </div>
                
    </form>
		</div><!-- **---wrap End---** -->
	</div> <!-- **---container End---** -->


	<!-- *---footer Start---* -->

  <footer class="footer">
	  <div class="con-footer">
	    <div class="left-footer">
	    </div>
	    <div class="middle-footer">
	      <p>Copyright ⓒ 2023 by invisible hand. All pictures cannot be copied without permission.</p>
	    </div>
	    <div class="right-footer">
	   </div>
	   </div>
  </footer>

	<!-- **---footer End---** -->
	
<script src="js/jquery-3.7.0.js"></script>
<script src="js/util.js"></script>
<script>
$(".categorybox").click(function() {
    $(this).siblings().removeClass("active");
    $(this).addClass("active");
   // $("html, body").scrollTop($(".tab-box").height());
    let clickTab = $(this).attr("data-tab");
    $(".tab-box").removeClass("active");
    $("." + clickTab).addClass("active");
});
</script>
<script>
  
      function moveToListView(){
        window.location.href ="${CP}/board/boardView.do?div="+$("#div").val();
      }
      
  
      $("#moveToList").on("click",function(){
          if(confirm('목록 화면으로 이동 하시겠습니까?')==false)return;
          
          moveToListView();
      });//--moveToList
      
      $("#doSave").on("click",function(){
          console.log("doSave");
          
          //필수 값: title, contents
          
          //JS
          //document.폼이름.input name.value
          let frmTitle = document.reg_frm.title.value;
          console.log("frmTitle:"+frmTitle);
          
          //input id값으로 값 가지고 오기
          //let sTitle = document.querySelector("#title").value;
          
          //class로 선택
          let sTitle = document.querySelector(".title_cls").value;
          //class값으로 값 가지고 오기
          
          
          console.log("sTitle:"+sTitle);
          
          //jquery
/*          if(eUtil.ISEmpty($("#title").val()) == true){
              alert("제목을 입력 하세요.");
              $("#title").focus();
              return;
          } */
          
          if(eUtil.ISEmpty($("#regId").val()) == true){
              alert("등록자를 입력 하세요.");
              $("#regId").focus();
              return;
          }         
          
          if(eUtil.ISEmpty($("#contents").val()) == true){
                alert("내용을 입력 하세요.");
                $("#contents").focus();
                return;             
          }
          
          
          //confirm
          if(confirm('등록 하시겠습니까')==false)return;
          
          //console.log("확인:");
          
          //ajax
            $.ajax({
                type: "POST",
                url:"/ehr/board/doSave.do",
                asyn:"true",
                dataType:"html",
                data:{
                  div: $("#div").val(),       
                  title: $("#title").val(),
                  regId: $("#regId").val(),
                  contents: $("#contents").val()  
                },
                success:function(data){//통신 성공
                    console.log("success data:"+data);
                    let parsedJson = JSON.parse(data);
                    //title 미 입력
                    if("10" == parsedJson.msgId ){
                        alert(parsedJson.msgContents);
                        $("#title").focus();
                        return;
                    }  
                
                     //등록자 미 입력
                     if("20" == parsedJson.msgId ){
                         alert(parsedJson.msgContents);
                         $("#regId").focus();
                         return;
                     }
                     
                     //등록자 미 입력
                     if("30" == parsedJson.msgId ){
                         alert(parsedJson.msgContents);
                         $("#contents").focus();
                         return;
                     }           
                     
                     
                     if("1" == parsedJson.msgId ){
                       alert(parsedJson.msgContents);
                       //javascript
                       //window.location.href ="${CP}/board/boardView.do?div="+$("#div").val();
                       moveToListView();
                     }else{
                       alert(parsedJson.msgContents);
                     }   
                },
                error:function(data){//실패시 처리
                    console.log("error:"+data);
                }
              });
          
          
      });//--doSave
  </script>  
</body>
</html>